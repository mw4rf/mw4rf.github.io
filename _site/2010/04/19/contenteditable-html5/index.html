<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title>Aperçu de l'attribut contenteditable en HTML5</title>
  <meta name="description" content="L'HyperText Markup Language, ou HTML, est le langage permettant de décrire la composition des pages Web que le navigateur interprète afin d'afficher le conte...">
  <link href="/public/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  
  <!-- Twitter Bootstrap -->
  <link rel="stylesheet" href='/assets/bootswatch/yeti.min.css'>
  <!-- Font Awesome -->
  <link rel="stylesheet" href='/assets/font-awesome/css/font-awesome.min.css'>
  git
  <link rel="stylesheet" href="/css/main.css">
  
  
  <link rel="canonical" href="http://www.valhalla.fr/2010/04/19/contenteditable-html5/">
  <link rel="alternate" type="application/atom+xml" title="Valhalla.fr" href="http://www.valhalla.fr/feed.xml" />
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://www.valhalla.fr">Valhalla.fr</a>
    </div>

    <div class="collapse navbar-collapse" id="navbar-collapse-1">
      
      <ul class="nav navbar-nav">
        
          
            <li>
            <a href="http://www.valhalla.fr/about.html">À Propos</a>
          
          </li>
        
          
            <li>
            <a href="http://www.valhalla.fr/revue/">Revue</a>
          
          </li>
        
          
            <li class="dropdown">
              <a href="http://www.valhalla.fr" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">Archives <i class="caret"></i></a>
              <ul class="dropdown-menu">
              
                <li><a href="http://www.valhalla.fr/articles-essentiels/">Articles essentiels</a></li>
              
                <li><a href="http://www.valhalla.fr/archives/index.html">Archives chronologiques</a></li>
              
                <li><a href="http://www.valhalla.fr/archives/categories.html">Catégories</a></li>
              
                <li><a href="http://www.valhalla.fr/archives/tags.html">Tags</a></li>
              
              </ul>
          
          </li>
        
          
            <li class="dropdown">
              <a href="http://www.valhalla.fr" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">Divers <i class="caret"></i></a>
              <ul class="dropdown-menu">
              
                <li><a href="http://www.valhalla.fr/outils/">Outils</a></li>
              
                <li><a href="http://www.valhalla.fr/java/">Java</a></li>
              
              </ul>
          
          </li>
        
      </ul>
      
      <!-- Google Custom Search Engine -->
      <form action="http://www.google.com/cse" id="cse-search-box" _lpchecked="1" class="navbar-form navbar-right" role="search">
        <input type="hidden" name="cx" value="007528237610497066360:tooxybveeoo">
        <input type="hidden" name="ie" value="UTF-8">
        <input name="siteurl" type="hidden" value="http://www.valhalla.fr">
        <input name="ref" type="hidden" value="">
        <input name="ss" type="hidden" value="">
        <div class="input-group input-group-sm">
          <input type="text" class="form-control" name="q" style="background: url(http://www.google.com/cse/intl/en/images/google_custom_search_watermark.gif) 0% 50% no-repeat rgb(255, 255, 255);">
        </div>
      </form>
      <!-- END Google Custom Search Engine -->
            
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

    <div id="page-content">
      <div class="container">
  <div class="row">
    <div class="col-md-2 col-sm-1"></div>
    <div class="col-md-8 col-sm-10 col-xs-12">
      <div class="page-header">
        <h1>
          Aperçu de l'attribut contenteditable en HTML5
          <small>Apr 19, 2010 • GF</small>
        </h1>
      </div>
      
      <div class="text-content"><p>L'<i><a href="http://fr.wikipedia.org/wiki/Hypertext_Markup_Language">HyperText Markup Language</a></i>, ou HTML, est le langage permettant de décrire la composition des pages Web que le navigateur interprète afin d'afficher le contenu à l'écran. Les <a href="http://www.w3.org/TR/#tr_HTML">spécifications</a> de ce langage sont établies par le <i><a href="http://www.w3.org/">World Wide Web Consortium</a></i> (W3C). La <a href="http://www.w3.org/TR/html5/">cinquième version du HTML</a>, en cours d'élaboration, est déjà partiellement intégrée à la plupart des navigateurs modernes. La balise &lt;video&gt; a monopolisé l'attention pendant un temps, mais l'HTML 5 offre d'autres <a href="http://www.w3.org/TR/html5-diff/">nouveautés</a>, dont le très important <a href="http://www.dicodunet.com/definitions/normes/attribut.htm">attribut</a> <strong>contenteditable</strong>.<br />
<a id="more"></a><a id="more-519"></a></p>
<h2>Utilité de l'attribut <i>contenteditable</i></h2>
<p>Le Web 2.0 est caractérisé par la transformations des internautes de simples lecteurs passifs en producteurs de contenu. L'exemple typique est Wikipédia, l'encyclopédie collaborative dans laquelle chaque internaute peut apporter sa contribution. D'un point de vue technique, cette transformation s'appuie sur des technologies bien connues depuis quelques années, comme Ajax, qui permet aux pages Web d'abandonner leur état purement statique pour devenir <em>interactives</em>. L'attribut <em>contenteditable</em> permet également cela, mais de manière plus simple et plus efficace.</p>
<p>Cet attribut permet de rendre n'importe quel conteneur, dans une page Web, directement modifiable. L'internaute a l'impression d'être face à un logiciel de traitement de texte plutôt qu'à une page Web.</p>
<p>Reprenons l'exemple de Wikipédia. Le lecteur qui souhaite corriger une erreur dans un article devra cliquer sur un lien, appelé "Modifier", qui le redirigera vers une page avec une zone d'édition du texte. Il devra ensuite rechercher le passage à corriger dans la zone d'édition (ce qui peut être pénible, en fonction de la longueur du texte), effectuer la modification, puis soumettre en formulaire en cliquant sur un bouton "Enregistrer les modifications". Au final, il aura dû charger deux pages, en plus de la page contenant l'article, avec tout ce que cela implique -- lenteur du chargement, perte de vue du texte avec le passage d'une page à l'autre, etc. La balise <em>contenteditable</em> résout ce problème en permettant d'effectuer les modifications directement sur la page d'origine.</p>
<h2>Démonstration de l'attribut <i>contenteditable</i></h2>
<p>Voici une démonstration. Il suffit de cliquer sur le texte ci-dessous pour le rendre directement modifiable :</p>
<p><span contenteditable="true" class="Code">Modifiez-moi !</span></p>
<p>L'utilisation de cette balise est un jeu d'enfant. Pour réaliser l'exemple ci-dessus, il a suffi d'écrire ceci :</p>
<p><code>&lt;span contenteditable="true"&gt;Modifiez-moi !&lt;/span&gt;</code></p>
<p>Le conteneur utilisé est un <strong>&lt;span&gt;</strong>, mais cela fonctionne de la même manière avec les autres conteneurs, notamment <strong>&lt;div&gt;</strong> et <strong>&lt;p&gt;</strong>. A l'heure actuelle, l'attribut <em>contenteditable</em> fonctionne avec Firefox 3.6, Safari 4, Opera 10.5, Chrome 5.</p>
<h2>Récupération des modifications avec JavaScript</h2>
<p>Définir un conteneur comme étant modifiable --c'est-à-dire offrir à l'utilisateur la possibilité de modifier le contenu-- ne sert à rien si l'on n'enregistre pas les modifications. L'attribut <i>contenteditable</i> ne permet pas, à lui seul, de faire cela. Son rôle se limite à rendre un conteneur modifiable. Il faudra donc utiliser JavaScript pour récupérer les modifications, puis pour les enregistrer (dans une base de données, par exemple).</p>
<p>Voici un exemple complet de la construction, pas à pas, d'une page qui offre à l'internaute de modifier un paragraphe de texte, et qui récupère ensuite les modifications grâce à JavaScript.</p>
<p>On commence par définir la structure de la page. Sur ce point, le HTML 5 ne change rien par rapport à la version précédente :<br />
<code>&lt;!DOCTYPE html&gt;<br />
&lt;html&gt;<br />
&lt;head&gt;<br />
	&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;<br />
	&lt;title&gt;test html5&lt;/title&gt;<br />
&lt;/head&gt;<br />
&lt;body&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;<br />
</code></p>
<p>On insère ensuite, dans le corps de cette page, un paragraphe modifiable avec l'<i>id</i> <b>test</b> :<br />
<code>&lt;body&gt;<br />
&lt;p id=&quot;test&quot; contenteditable=&quot;true&quot;&gt;<br />
	Lorem Impsum...<br />
&lt;/p&gt;<br />
&lt;/body&gt;<br />
</code></p>
<p>On place, entre les balises <em>&lt;head&gt;</em> et <em>&lt;/head&gt;</em>, un code JavaScript permettant :
<ul>
<li>De récupérer le conteneur grâce à son <i>id</i><em> (1ère fonction)</em></li>
<li>De récupérer le contenu <em>(2ème fonction)</em></li>
<li>D'afficher un message avec ce contenu <em>(3ème fonction)</em></li>
</ul>
<p><code>&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;<br />
	function $(element) { return document.getElementById(element) }<br />
	function $H(element) { return $(element).innerHTML }<br />
	function test() { alert($H(&#x27;test&#x27;)) }<br />
&lt;/script&gt;<br />
</code></p>
<p>Pour finir, on place un code JavaScript à la fin de la page, juste avant la balise <em>&lt;/html&gt;</em>, qui permet :
<ul>
<li>D'attacher un gestionnaire d'événements au paragraphe modifiable : lorsque l'utilisateur valide sa modification, en cliquant en dehors de la zone modifiable, n'importe où sur la page, la fonction <i>test()</i> précédemment définie est appelée.</li>
<li>D'activer la correction orthographique du navigateur dans le paragraphe modifiable.</li>
</ul>
<p><code>&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;<br />
	$(&#x27;test&#x27;).addEventListener(&quot;blur&quot;, test, false)<br />
	$(&#x27;test&#x27;).spellcheck = &#x27;true&#x27;<br />
&lt;/script&gt;<br />
</code></p>
<p>L'élément modifiable, doté de l'attribut <em>contenteditable</em>, gère deux actions : <strong>focus</strong> et <strong>blur</strong>. La première est déclenchée lorsque l'utilisateur clique sur l'élément afin de le modifier, et la seconde lorsqu'il valide les modifications (un clic ailleurs sur la page, ou une pression sur la touche Tab, par exemple).</p>
<p>A noter qu'il est possible de rendre une page modifiable dans son ensemble, par JavaScript, grâce à l'instruction suivante :<br />
<code>document.designMode = 'true'</code></p>
<p>La page est terminée. Notre paragraphe peut être édité et les modifications sont récupérées par Javascript lorsque l'utilisateur les valide en sortant de la zone modifiable.</p>


<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
	<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;title&gt;</span>test html5<span class="nt">&lt;/title&gt;</span>
	<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
		<span class="kd">function</span> <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">}</span>
		<span class="kd">function</span> <span class="nx">$H</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="p">}</span>
		<span class="kd">function</span> <span class="nx">test</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">$H</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">))</span> <span class="p">}</span>
	<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;p</span> <span class="na">id=</span><span class="s">&quot;test&quot;</span> <span class="na">contenteditable=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
	Lorem Impsum...
<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
	<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;blur&quot;</span><span class="p">,</span> <span class="nx">test</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
	<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">).</span><span class="nx">spellcheck</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;/html&gt;</span></code></pre></div>


<h2>Enregistrer les modifications avec Ajax</h2>
<p>Dans l'exemple précédent, le nouveau contenu du paragraphe est simplement affiché dans une boîte de dialogue modale -- <em>alert()</em> -- : c'est tout ce que fait la fonction <strong>test()</strong>. Mais il est bien entendu possible de modifier cette fonction, afin d'enregistrer le nouveau contenu dans une base de données. Une requête AJAX serait particulièrement adaptée à cela.</p>
<p>Il existe de nombreux frameworks Ajax. Pour n'en citer que trois, parmi les plus célèbres : <a href="http://jquery.com/">jQuery</a>, <a href="http://www.prototypejs.org/">Prototype</a>, <a href="http://mootools.net/">MooTools</a>. Chacun a sa propre syntaxe ; c'est pourquoi il est difficile --- et inutile -- de créer ici un exemple qui conviendra à tous les lecteurs.</p>
<p>Voyons tout de même, dans les grandes lignes, comment faire. Côté JavaScript, on modifie la fonction <em>test()</em> pour récupérer l'<i>id</i> du paragraphe et son contenu :<br />
<code><br />
function test()<br />
{<br />
	test_contenu = document.getElementById('test').innerHTML<br />
</code></p>
<p><em>NB: JQuery et Prototype implémentent la fonction $() ; il faudra donc supprimer la fonction $(element) définie ci-dessus.</em></p>
<p>On rajoute ensuite l'appel Ajax, de manière différente selon le framework utilisé.</p>
<p>Exemple avec JQuery :<br />
<code><br />
	$.ajax({<br />
		type: "POST",<br />
		url: "test_update.php",<br />
		data: {contenu:test_contenu}<br />
	});<br />
}<br />
</code></p>
<p>Exemple avec Prototype :<br />
<code><br />
	new Ajax.Updater("",<br />
		"test_update.php",<br />
		{<br />
			method:'post',<br />
			parameters: {contenu:test_contenu}<br />
		}<br />
	)<br />
}<br />
</code></p>
<p>Reste ensuite à créer la page <strong>test_update.php</strong>, appelée par Ajax, afin de traiter les données transmises par la requête asynchrone.<br />
<code><br />
&lt;?php<br />
	if(!empty($_POST[&#x27;contenu&#x27;]))<br />
	{<br />
		$contenu = addslashes($_POST[&#x27;contenu&#x27;]);<br />
		$sql = &quot;UPDATE ma_table SET contenu = &#x27;$contenu&#x27; WHERE...&quot;;<br />
		@mysql_query($sql);<br />
	}<br />
?&gt;<br />
</code></p>
<p>Le code présenté ici n'est pas sécurisé (pas de contrôle de la donnée de formulaire transmise), et il ne fonctionne pas car il n'est pas indiqué <i>où</i> (clause WHERE) les modifications doivent être faites. Il est cependant très facile, en modifiant un peu le code JavaScript, de récupérer l'<i>id</i> du paragraphe et d'identifier ainsi la bonne ligne dans la base de données.</p>
<hr />
A Paris, le 18 avril 2010</p>
</p>
</div>
      
      <hr>
      
      <div class="related">
        <h2>Voir aussi</h2>
        <ul style="list-style-type: none;">
        
            <li><a href="/2015/01/04/pagination-selective-avec-jekyll/">Pagination sélective avec Jekyll</a></li>
        
            <li><a href="/2015/01/03/de-wordpress-a-jekyll/">De WordPress à Jekyll</a></li>
        
            <li><a href="/2014/08/05/safari-raccourci-clavier-pour-affichermasquer-la-barre-des-signets/">Safari : raccourci clavier pour afficher/masquer la barre des signets</a></li>
        
            <li><a href="/2014/08/01/lancer-intellij-idea-13-mac-avec-un-jdk-oracle/">Lancer Intellij IDEA 13 Mac avec un JDK Oracle</a></li>
        
            <li><a href="/2013/01/08/ubuntu-12-10-checklist-installation/">Ubuntu 12.10 : Checklist d'installation</a></li>
        
            <li><a href="/2012/07/08/107/">Numéro 107 - Semaine du 2 au 8 juillet 2012</a></li>
        
            <li><a href="/2012/07/01/106/">Numéro 106 - Semaine du 25 juin au 1er juillet 2012</a></li>
        
            <li><a href="/2012/06/24/105/">Numéro 105 - Semaine du 18 au 24 juin 2012</a></li>
        
            <li><a href="/2012/06/16/optimiser-unity-workspaces-precise-pangolin/">Optimiser les bureaux virtuels sous Unity (Ubuntu 12.04)</a></li>
        
            <li><a href="/2012/06/11/ubuntu-software-center-tester-avant-dinstaller/">Ubuntu Software Center : tester avant d'installer</a></li>
        
        </ul>
      </div>
      
      
      <hr>
      <div class="comments">
        <div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = 'valhallafr';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
      </div>
      
      
    </div>
    <div class="col-md-2 col-sm-1">
  </div>
</div>

    </div>

    <div class="container-fluid" id="footer">
  <div class="row">
    
    <div class="col-md-4 col-sm-6">
      <ul class="no-bullet">
        <li>Valhalla.fr</li>
        <li>Ad Absurdum</li>
        <li><small>Tous droits réservés, sauf mention contraire.</small></li>
        <li><small>Mis à jour le  4 Jan 2015 à 22h48.</small></li>
      </ul>
    </div>
    
    <div class="col-md-4 col-sm-6">
      <a href="mailto:your-email@domain.com" id="gh" target="_blank" title="Contact">
        <span class="fa-stack fa-lg">
          <i class="fa fa-at fa-stack-1x"></i>
        </span>
        your-email@domain.com
      </a>
      <br>
      <a href="http://www.valhalla.fr/feed.xml" id="gh" target="_blank" title="RSS">
        <span class="fa-stack fa-lg">
          <i class="fa fa-rss-square fa-stack-1x"></i>
        </span>
        RSS
        </a>
    </div>
    
    <div class="col-md-4 col-sm-6">
      
      <a href="https://twitter.com/jekyllrb" id="gh" target="_blank" title="Twitter">
        <span class="fa-stack fa-lg">
          <i class="fa fa-twitter fa-stack-1x"></i>
        </span>
        Twitter
      </a>
      
      
      <br>
      <a href="https://github.com/mw4rf"  target="_blank" title="GitHub">
        <span class="fa-stack fa-lg">
          <i class="fa fa-github fa-stack-1x"></i>
        </span>
        GitHub
      </a>
      
    </div>
    
  </div>
</div>

      <script src="/assets/jquery.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="/assets/bootstrap/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2290016-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>

</html>
