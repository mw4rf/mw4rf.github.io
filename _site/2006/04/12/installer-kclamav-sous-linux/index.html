<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title>Installer K/ClamAV sous Linux ?</title>
  <meta name="description" content="En lisant les nouvelles ce matin, j'ai appris que des programmeurs avaient réalisé un virus crossplatform en Assembleur. Il fonctionne aussi bien sous Window...">
  <link href="/public/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  
  <!-- Twitter Bootstrap -->
  <link rel="stylesheet" href='/assets/bootswatch/yeti.min.css'>
  <!-- Font Awesome -->
  <link rel="stylesheet" href='/assets/font-awesome/css/font-awesome.min.css'>
  git
  <link rel="stylesheet" href="/css/main.css">
  
  
  <link rel="canonical" href="http://www.valhalla.fr/2006/04/12/installer-kclamav-sous-linux/">
  <link rel="alternate" type="application/atom+xml" title="Valhalla.fr" href="http://www.valhalla.fr/feed.xml" />
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://www.valhalla.fr">Valhalla.fr</a>
    </div>

    <div class="collapse navbar-collapse" id="navbar-collapse-1">
      
      <ul class="nav navbar-nav">
        
          
            <li>
            <a href="http://www.valhalla.fr/about.html">À Propos</a>
          
          </li>
        
          
            <li>
            <a href="http://www.valhalla.fr/revue/">Revue</a>
          
          </li>
        
          
            <li class="dropdown">
              <a href="http://www.valhalla.fr" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">Archives <i class="caret"></i></a>
              <ul class="dropdown-menu">
              
                <li><a href="http://www.valhalla.fr/articles-essentiels/">Articles essentiels</a></li>
              
                <li><a href="http://www.valhalla.fr/archives/index.html">Archives chronologiques</a></li>
              
                <li><a href="http://www.valhalla.fr/archives/categories.html">Catégories</a></li>
              
                <li><a href="http://www.valhalla.fr/archives/tags.html">Tags</a></li>
              
              </ul>
          
          </li>
        
          
            <li class="dropdown">
              <a href="http://www.valhalla.fr" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">Divers <i class="caret"></i></a>
              <ul class="dropdown-menu">
              
                <li><a href="http://www.valhalla.fr/outils/">Outils</a></li>
              
                <li><a href="http://www.valhalla.fr/java/">Java</a></li>
              
              </ul>
          
          </li>
        
      </ul>
      
      <!-- Google Custom Search Engine -->
      <form action="http://www.google.com/cse" id="cse-search-box" _lpchecked="1" class="navbar-form navbar-right" role="search">
        <input type="hidden" name="cx" value="007528237610497066360:tooxybveeoo">
        <input type="hidden" name="ie" value="UTF-8">
        <input name="siteurl" type="hidden" value="http://www.valhalla.fr">
        <input name="ref" type="hidden" value="">
        <input name="ss" type="hidden" value="">
        <div class="input-group input-group-sm">
          <input type="text" class="form-control" name="q" style="background: url(http://www.google.com/cse/intl/en/images/google_custom_search_watermark.gif) 0% 50% no-repeat rgb(255, 255, 255);">
        </div>
      </form>
      <!-- END Google Custom Search Engine -->
            
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

    <div id="page-content">
      <div class="container">
  <div class="row">
    <div class="col-md-2 col-sm-1"></div>
    <div class="col-md-8 col-sm-10 col-xs-12">
      <div class="page-header">
        <h1>
          Installer K/ClamAV sous Linux ?
          <small>Apr 12, 2006 • GF</small>
        </h1>
      </div>
      
      <div class="text-content"><p><img src="/public/posts/2006-04-12-clamav/clamav.png" align="left" alt="ClamAV Logo" /><br />
En lisant les nouvelles ce matin, j'ai appris que des programmeurs avaient réalisé un virus crossplatform en Assembleur. Il fonctionne aussi bien sous Windows que sous Linux, et peut servir de base à d'autres auteurs de virus pour mettre en oeuvre leur savoir destructeur. Heureusement, ce virus-là n'en est pas réellement un, c'est plutot un guide donnant les lignes directrices pour une comaptibilité avec les deux systèmes. Ca m'a donné une idée: installer l'antivirus ClamAV, opensource et gratuit. Ce n'était pas par nécessité, puisque je n'ai aucune peur de ce virus, que je sais quand comment et pourquoi je suis susceptible de me faire infecter, et que le poste sur lequel j'ai réalisé l'installation peut se permettre de planter et de voir son système réinstallé après formatage. Non, si j'ai installé cet antivirus, ce n'était que pour le tester. Et bien, je n'ai pas été déçu ! En effet, l'installation de l'interface graphique, KlamAV (qui se détâche de ClamAV, celui-ci s'exécutant normalement en ligne de commande), est un vrai parcours du combattant. C'est donc tout naturellement que j'ai entrepris d'écrire cet article qui aura pour but d'expliquer comment installer et configurer ClamAV et l'interface KlamAV sous Linux. Dernière précision avant de commencer: les étapes décrites sont basées sur une OpenSuse 10; elles demeurent valables pour la plupart des grosses distributions (RedHat, Mandrake/Mandriva, etc.), mais seront peut être légèrement différentes pour les distributions basées sur Debian.</p>
<p><a id="more"></a><a id="more-96"></a></p>
<h2>Première étape: Installation du moteur ClamAV</h2>
<p>Paradoxalement, c'est l'étape la plus simple. Mais cela vaut la peine de faire quelques efforts pour obtenir une belle interface graphique, car ClamAV en ligne de commande est un peu spartiate !</p>
<p>Avant tout, il faut récupérer le logiciel. Vous le trouverez:<br />
- <a href="http://www.clamav.net/">Sur le site officiel</a> (source)<br />
- <a href="ftp://ftp.suse.com/pub/projects/clamav">Sur un FTP non-officiel</a> (RPM)</p>
<p>Pour installer le RPM, vous n'aurez normalement aucun problème: téléchargement sur le bureau par exemple, (double)clic sur l'icône du RPM, clic sur le bouton "Installer", mot de passe root, on attend quelques secondes et c'est fini. Je vous conseille d'installer ClamAV par ce moyen, sauf si vous avez envie de le compiler.</p>
<p>Pour compiler ClamAV depuis les sources, ce n'est pas bien difficile. Il vous faut cependant avoir installé le compileur et les librairies nécessaires. L'installation se déroule normalement:<br />
    

<div class="highlight"><pre><code class="language-bash" data-lang="bash">./configure
make
sudo make install 
<span class="o">[</span>Un mot de passe adminsitrateur <span class="o">(</span>root<span class="o">)</span> est demandé ici<span class="o">]</span></code></pre></div>


<p>En avant pour une explication, une bonne fois pour toutes:<br />
1) Ces commandes sont à taper dans le terminal. Si un mot de passe est demandé, il faut bien entendu le fournir (il n'apparaît pas à l'écran pendant qu'on l'écrit, pour des raisons de sécurité).<br />
2) Il ne faut pas s'affoler si "tout plein" de messages défilent à l'écran: ignorez-les, tant que ça défile c'est que tout va bien. Si au contraire cela ne défile plus, deux possibilités: c'est fini, il y a un problème. S'il y a un problème, dans 99% des cas, ce sera un dépendance non satisfaite.<br />
3) Les logiciels que vous installez ont besoin de bibliothèques ("lib" pour "libraries"). Si une de ces bibliothèques est absente, le logiciel ne s'installera pas (ne se compilera pas). Il vous faudra trouver la bibliothèque manquante pour résoudre le conflit de dépendance, et pouvoir compiler le logiciel.<br />
4) Pour trouver le maillon manquant, la meilleure solution reste le gestionnaire de paquetages de votre distribution (gestionnaire de RPM). Pour Mandriva, pensez aussi à URPMI. Si vous ne pouvez obtenir le paquetage nécessaire par ce moyen, allez faire un tour sur http://rpmfind.net<br />
5) N'oubliez pas: il y a toujours un problème, mais il n'est pas toujours difficile à résoudre. Quand on a l'habitude (au bout de 4 ou 5 logiciels compilés...) on repère le fichier manquant en un coup d'oeil et on l'obtient/installe en 2 minutes. Il faut garder son calme (c'est parfois difficile avec Linux!) et procéder méthodiquement.</p>
<h2>Deuxième étape: obtenir KlamAV et Dazuko</h2>
<p>Vous devez obtenir KlamAV lui-même pour commencer:<br />
- <a href="http://klamav.sourceforge.net/">Depuis le site officiel</a> (installer)<br />
- Séparément en deux parties: <a href="http://klamav.sourceforge.net/">depuis le site officiel</a> (source) et avec <a href="http://www.dazuko.org">Dazuko</a> (sources)</p>
<p>Petite explication. KlamAV est fourni sous la forme d'un "installer": un script avec interface graphique à la Windows, qui permet d'installer le logiciel en cliquant plusieurs fois sur "suivant". Mais à la différence des logiciels Windows de ce type, "l'installer" de KlamAV ne vous exonère pas de la phase de préparation de l'installation (recherche des dépendances notamment). Il ne fait qu'automatiser les étapes de configuration et de compilation. Il en découle qu'utiliser l'installer ou non revient exactement au même pour ce qui est des ennuis que nous allons rencontrer. La seul intérêt de l'installer est qu'il contient déjà les sources de KlamAV et de Dazuko, élément nécessaire à l'installation, et qu'il s'occupe de les compiler pour vous "si tout va bien". Nous allons par la suite utiliser cet "installer", et la suite de cet article aura pour but unique de faire en sorte que "tout aille bien".</p>
<p>Si vous décidez de ne pas utiliser l'installer, ce n'est pas vraiment plus compliqué. Vous devrez installer Dazuko manuellement (<span class="Code">./configure, make, make install</span>) après avoir suivi la troisième étape de cet article, puis installer KlamAV, soit en passant par le script d'installation (<span class="Code">sh install.sh</span>), soit par la procédure normale (<span class="Code">./configure &amp;&amp; make &amp;&amp; su -c 'make install'</span>).</p>
<h2>Troisième étape: préparation de l'installation de Dazuko</h2>
<p>Avant de lancer l'installation, il faut préparer le terrain. Et cela, le script d'installation ne le fait pas. C'est à vous de le faire.</p>
<p>Pour installer Dazuko, il vous faut posséder les sources du noyau linux (kernel-sources). Ce n'est pas compliqué: lancez votre gestionnaire de RPM (de KDE, de Mandriva, Yast pour Suse, etc, toutes les distributions grand public en ont un), et recherchez "kernel". Une des entrées sera certainement "kernel-sources" ou quelque chose de ressemblant. Si le gestionnaire indique que les sources sont déjà installées, c'est bon, sinon installez les (vous aurez besoin du CD/DVD de votre distribution, et d'à peu près 200 Mo sur le disque).</p>
<p>Mais avoir les sources n'est pas tout, encore faut-il pouvoir les exploiter. Pour cela, vous devez posséder un compileur. Ou plutot LE compileur, le fameur "gcc". Rendez-vous de nouveau dans votre gestionnaire de paquetages, et recherchez "gcc". En règle générale, vous aurez besoin des éléments suivants:</p>
<ul>
<li /><span class="Code">gcc</span> (version 4+)
<li /><span class="Code">gcc-c++</span> (version identique à celle de "gcc")
<li /><span class="Code">gpp</span> (idem)
<li /><span class="Code">libgcc</span> (idem!)
</ul>
<p>Une fois les sources installées, vous devez le configurer. C'est un peu plus difficile. Ouvrez une fenêtre de terminal, et tapez:<br />


<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /usr/src/linux
make cloneconfig
make modules_prepare</code></pre></div>


<p>La dernière ligne devrait être quelque chose dans le genre (SUSE):<br />


<div class="highlight"><pre><code class="language-bash" data-lang="bash">CHK     /usr/src/linux-2.6.13-15/include/linux/version.h&lt;br /&gt;
make<span class="o">[</span>1<span class="o">]</span>: <span class="sb">`</span>arch/i386/kernel/asm-offsets.s<span class="err">&#39;</span> is up to date.&lt;br /&gt;</code></pre></div>


Sinon, refaire un "make modules_prepare".</p>

<p>Si plus loin lors de la compilation (make) de KlamAV, vous avez le message suivant (ou un message approchant), c'est que cette étape n'a pas été réalisée, ou a été mal réalisée: <span class="Code">/bin/sh scripts/basic/fixdep: File not found</span>.</p>
<p>Vous devrez ensuite configurer <i>Module.symvers</i>, absent des sources par défaut:<br />


<div class="highlight"><pre><code class="language-bash" data-lang="bash">cp /boot/symvers-2.6.13-15-i386-default.gz /usr/src/linux&lt;br /&gt;
mv symvers-2.6.13-15-i386-default.gz Module.symvers.gz&lt;br /&gt;
gunzip /usr/src/linux/Module.symvers.gz&lt;br /&gt;
make modules_prepare&lt;br /&gt;</code></pre></div>


<p>Si plus loin lors de la compilation (make) de KlamAV, vous avez le message suivant (ou un message approchant), c'est que cette étape n'a pas été réalisée, ou a été mal réalisée: <span class="Code">/bin/sh scripts/modules/Module.symvers: File not found</span>.</p>
<p>C'est terminé pour Dazuko. Si vous avez décidé d'installer Dazuko et KlamAV séparément, sans utiliser "l'installer" de KlamAV, vous pouvez dors et déjà installer Dazuko. En revanche, si vous suivez à la lettre cet article, attendez un peu, il nous reste quelques petites choses à régler avant de lancer l'installation conjointe des deux éléments.</p>
<h2>Quatrième étape: préparation de l'installation de KlamAV</h2>
<p>Nous devons satisfaire quelques dépendances. Pour cela, il faut installer les paquetages suivants, avec le gestionnaire de RPM de votre distribution:<br />
<span class="Code">
<ul>
<li />kdelibs3-devel
<li />kdebase3-devel
<li />kdebindings3
<li />qt3-devel-tools
<li />qt3-extensions
<li />qt3-static
<li />libjpeg-devel
<li />curl-devel
</ul>
<p></p>
<p>Le fichier <span class="Code">libcurl.so</span> est nécessaire à l'installation. Il faut vérifier qu'il est bien présent. Rendez-vous pour cela dans <span class="Code">/usr/lib/</span> et tapez <span class="Code">find libcurl*</span>. Vous devriez obtenir une liste contenant ce fichier. Si c'est le cas c'est bon ! Sinon (comme c'est le cas avec SUSE) vous devrez effectuer la manipulation suivante: vérifiez qu'il y a dans la liste <span class="Code">libcurl.so.3</span> et/ou <span class="Code">libcurl.so.3.0.0</span>. Vous avez ensuite le choix entre deux possibilités: la première est plus "clean", la seconde est plus sûre. 1) Créez un lien logique: <span class="Code">ln -s libcurl.so.3.0.0 libcurl.so</span>, ou 2) recopiez le fichier: <span class="Code">cp libcurl.so.3.0.0 libcurl.so</span>.</p>
<h2>Cinquième étape: installation assistée de KlamAV</h2>
<p>Nous pouvons maintenant installer KlamAV avec l'installeur fourni. Avant de commencer, vous devrez peut être taper en ligne de commande <span class="Code">modprobe dazuko</span>, pour le lancer s'il ne l'est pas. </p>
<p>Lancez l'installeur en cliquant simplement dessus. Il se chargera de créer pour vous le compte utilisateur "clamav" avant de lancer une interface graphique dans laquelle il vous suffira effectivement de cliquer sur "suivant" et d'attendre que le travail se fasse tout seul.</p>
<p>Une fois l'installation terminée, vous pourrez trouver KlamAV à l'emplacement suivant (faut y penser...):<br />
<span class="Code">/usr/local/kde/bin/klamav</span></p>
<p>Vous pouvez ajouter cette dernière ligne au menu K où créer une icone sur votre bureau.</p>
<p>Petite précision finale: si cela ne fonctionne plus après avoir redémarré la machine, c'est probablement parce que Dazuko n'est pas lancé. Dans ce cas, <span class="Code">modprobe dazuko</span> dans une fenêtre de terminal.</p>
</span></p></p></p></p>
</div>
      
      <hr>
      
      <div class="related">
        <h2>Voir aussi</h2>
        <ul style="list-style-type: none;">
        
            <li><a href="/2015/01/04/pagination-selective-avec-jekyll/">Pagination sélective avec Jekyll</a></li>
        
            <li><a href="/2015/01/03/de-wordpress-a-jekyll/">De WordPress à Jekyll</a></li>
        
            <li><a href="/2014/08/05/safari-raccourci-clavier-pour-affichermasquer-la-barre-des-signets/">Safari : raccourci clavier pour afficher/masquer la barre des signets</a></li>
        
            <li><a href="/2014/08/01/lancer-intellij-idea-13-mac-avec-un-jdk-oracle/">Lancer Intellij IDEA 13 Mac avec un JDK Oracle</a></li>
        
            <li><a href="/2013/01/08/ubuntu-12-10-checklist-installation/">Ubuntu 12.10 : Checklist d'installation</a></li>
        
            <li><a href="/2012/07/08/107/">Numéro 107 - Semaine du 2 au 8 juillet 2012</a></li>
        
            <li><a href="/2012/07/01/106/">Numéro 106 - Semaine du 25 juin au 1er juillet 2012</a></li>
        
            <li><a href="/2012/06/24/105/">Numéro 105 - Semaine du 18 au 24 juin 2012</a></li>
        
            <li><a href="/2012/06/16/optimiser-unity-workspaces-precise-pangolin/">Optimiser les bureaux virtuels sous Unity (Ubuntu 12.04)</a></li>
        
            <li><a href="/2012/06/11/ubuntu-software-center-tester-avant-dinstaller/">Ubuntu Software Center : tester avant d'installer</a></li>
        
        </ul>
      </div>
      
      
      <hr>
      <div class="comments">
        <div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = 'valhallafr';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
      </div>
      
      
    </div>
    <div class="col-md-2 col-sm-1">
  </div>
</div>

    </div>

    <div class="container-fluid" id="footer">
  <div class="row">
    
    <div class="col-md-4 col-sm-6">
      <ul class="no-bullet">
        <li>Valhalla.fr</li>
        <li>Ad Absurdum</li>
        <li><small>Tous droits réservés, sauf mention contraire.</small></li>
        <li><small>Mis à jour le  4 Jan 2015 à 22h41.</small></li>
      </ul>
    </div>
    
    <div class="col-md-4 col-sm-6">
      <a href="mailto:your-email@domain.com" id="gh" target="_blank" title="Contact">
        <span class="fa-stack fa-lg">
          <i class="fa fa-at fa-stack-1x"></i>
        </span>
        your-email@domain.com
      </a>
      <br>
      <a href="http://www.valhalla.fr/feed.xml" id="gh" target="_blank" title="RSS">
        <span class="fa-stack fa-lg">
          <i class="fa fa-rss-square fa-stack-1x"></i>
        </span>
        RSS
        </a>
    </div>
    
    <div class="col-md-4 col-sm-6">
      
      <a href="https://twitter.com/jekyllrb" id="gh" target="_blank" title="Twitter">
        <span class="fa-stack fa-lg">
          <i class="fa fa-twitter fa-stack-1x"></i>
        </span>
        Twitter
      </a>
      
      
      <br>
      <a href="https://github.com/mw4rf"  target="_blank" title="GitHub">
        <span class="fa-stack fa-lg">
          <i class="fa fa-github fa-stack-1x"></i>
        </span>
        GitHub
      </a>
      
    </div>
    
  </div>
</div>

      <script src="/assets/jquery.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="/assets/bootstrap/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2290016-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>

</html>
